# üß† ML-Enhanced Adaptive Pivot Analysis

A machine learning-powered trading system that combines traditional technical analysis with deep learning to generate adaptive trading signals. The system uses LSTM neural networks with attention mechanisms to analyze market patterns and automatically adjusts its parameters based on market volatility.

## üöÄ Features

- Advanced Neural Network Architecture
  - LSTM with multi-head attention mechanism for sequence modeling
  - Confidence scoring system for signal reliability
  - Adaptive parameter optimization based on market conditions
- Volatility-Adaptive Analysis
  - Dynamic pivot period adjustment (5-25 periods)
  - Adaptive channel width calculation (1-8%)
  - Multi-metric volatility scoring system
- Comprehensive Technical Analysis
  - Support/Resistance level detection
  - MACD with weighted moving averages
  - RSI, Bollinger Bands, ATR indicators
  - Sequential pattern recognition (buy/sell sequences)
- Multi-Stock Training Capability
  - Train on multiple stocks simultaneously
  - Cross-validation with train/validation splits
  - Model persistence and loading

## üìä System Architecture

TradingSignalNet

```python
class TradingSignalNet(nn.Module):
    - LSTM layers with dropout
    - Multi-head attention mechanism
    - Signal classification (buy/hold/sell)
    - Confidence scoring output
```

VolatilityAdaptiveSystem

- Historical volatility calculation
- ATR-based volatility measurement
- Bollinger Band width analysis
- Composite volatility scoring

EnhancedAdaptiveTradingSystem

- Main orchestrator class
- ML model integration
- Traditional signal generation
- Hybrid signal combination

## üõ†Ô∏è Installation

```python
pip install -r requirements.txt
```

## üí° Quick Start

Basic Usage

```python
from trading_system import EnhancedAdaptiveTradingSystem

# Initialize system
system = EnhancedAdaptiveTradingSystem()

# Train on multiple stocks
training_tickers = ['AAPL', 'GOOGL', 'MSFT', 'TSLA', 'AMZN']
system.train_on_multiple_stocks(training_tickers, epochs=100)

# Analyze a specific stock
result = system.adaptive_dca_indicator("AAPL")
df, sr_levels, fig, ax, signal, confidence, analysis = result
```

Complete Training and Analysis

```python
# Run full training and analysis pipeline
result = run_training_and_analysis("AAPL", train_first=True, epochs=100)
```

## üìà Signal Generation

The system generates three types of signals:

| Signal  | Description | Confidence Range |
| ------------- | ------------- | ------------- |
| BUY | Strong bullish indicators | 70-95% |
| HOLD  | Neutral/unclear conditions | 40-70% |
| SELL | Strong bearish indicators | 70-95% |

Signal Combination Logic

1. ML Signal: Generated by trained LSTM model
2. Traditional Signal: Based on technical indicators
3. Final Signal: Weighted combination based on confidence scores

## üéØ Key Parameters

Adaptive Parameters

| Parameter  | Low Volatility | High Volatility | Purpose |
| ------------- | ------------- | ------------- | ------------- |
| Pivot Period | 25 periods  | 5 periods | Trend detection sensitivity |
| Channel Width | 1-3% | 6-8% | Support/resistance tolerance |
| Volatility Lookback | 20 periods | 20 periods | Volatility calculation window |

Model Architecture

- Input Features: 15 technical indicators
- LSTM Hidden Size: 64 units
- LSTM Layers: 2 layers
- Attention Heads: 8 heads
- Dropout Rate: 20%

## üîß Advanced Configuration

Custom Model Training

```python
# Initialize with custom parameters
model = TradingSignalNet(
    input_size=15,
    hidden_size=128,  # Increase for more complexity
    num_layers=3,     # Add more LSTM layers
    dropout=0.3       # Adjust dropout rate
)

system = EnhancedAdaptiveTradingSystem()
system.model = model
```

Volatility System Tuning

```python
# Customize volatility parameters
system.volatility_system.min_pivot_period = 3
system.volatility_system.max_pivot_period = 30
system.volatility_system.min_channel_width = 0.5
system.volatility_system.max_channel_width = 10
```

## üìã Output Analysis

Signal Analysis Structure

```python
analysis = {
    'current_price': 150.25,
    'nearest_sr_level': 148.50,
    'distance_to_sr': 1.2,
    'macd_signal': 'bullish',
    'ml_signal': 'buy',
    'ml_confidence': 0.85,
    'traditional_signal': 'buy',
    'signal_agreement': True,
    'adaptive_params': {
        'pivot_period': 10,
        'channel_width_pct': 3.5,
        'proximity_threshold_pct': 3.5
    }
}
```

## üöÄ Performance Optimization

Training Tips: 
1. Use GPU acceleration when available.
2. Increase batch size for faster training.
3. Monitor validation loss to prevent overfitting.

Memory Management:
1. System handles large datasets efficiently.
2. Automatic data cleaning and preprocessing.
3. Optimized feature scaling and normalization.

## üìù License

This project is licensed under the GPL v3 - see the [(https://img.shields.io/badge/License-GPLv3-blue.svg)](https://www.gnu.org/licenses/gpl-3.0) file for details.

## üìß Contact

Yavuz Akbay - akbay.yavuz@gmail.com

‚≠êÔ∏è If this project helped with your financial analysis, please consider giving it a star!

üö® Disclaimer
This tool is for educational and research purposes only. Not financial advice. Always consult with qualified financial professionals before making investment decisions.
